# Исследование дискретной цепи Маркова

## Теоретическая основа
1) Определение случайной величины.

**Случайная величина** — это переменная, значения которой представляют собой исходы какого-нибудь случайного феномена или эксперимента. Иными словами: это численное выражение результата случайного события.

2) Определение цепи Маркова.

Модель Марковского процесса представляет собой граф, где узлы обозначают состояние моделируемого объекта, а дуги – вероятность перехода из одного состояния в другое.


3) Классификация цепей Маркова.

- *Дискретные цепи Маркова* — система меняет свое состояние в определенные такты времени (P-схема)

- *Непрерывные цепи Маркова* — система меняет свое состояние в произвольный момент времени (q-схема)


4) Вероятность перехода.

В марковской цепи вероятность события зависит только от текущего состояния цепи.

5) Стохастическая матрица.

Стохастическая матрица — это неотрицательная матрица, чьи строки или колонки дают в сумме единицу. Стохастическая матрица справа является матрицей переходных вероятностей для некоторой цепи Маркова.

6) Достаточное условие эргодичности

Эргодической называется неразложимая и нециклическая марковская система. Для такой системы имеется возможность определить стационарные вероятности (т.е. вероятности событий при времени, стремящимся к бесконечности (или числе шагов моделирования, стремящимся к бесконечности)). Вероятности этих состояний не зависят от вероятностей системы в начальный момент.

*Теорема эргодичности:* если для конечной марковской цепи найдется такой номер шага, на котором все вероятности перехода положительны, то такая цепь является эргодической.

## Практическая часть

### Матрица переходных состояний для эргодической цепи

| | S1 | S2 | S3 | S4 | S5 | S6 | S7 | S8 |
|--|--|--|--|--|--|--|--|--|
| **S1** | 0.2 | 0 | 0.4 | 0.1 | 0 | 0 | 0.15 | 0.15 |
| **S2** |0 | 0.1| 0 | 0.2 | 0.5 | 0 | 0.2 | 0 |
| **S3** |0.1 | 0 | 0.1 | 0 | 0 | 0.4 | 0.3 | 0.1 |
| **S4** | 0 | 0.1 | 0 | 0.3 | 0 | 0 | 0.3 | 0.3 | 
| **S5** | 0.4 | 0 | 0.2 | 0.2 | 0.1 | 0.1 | 0 | 0 |
| **S6** | 0 | 0.3 | 0.15 | 0 | 0.4 | 0.1 | 0 | 0.05 |
| **S7** | 0.1 | 0.2 | 0.05 | 0.1 | 0 | 0.2 | 0.05 | 0.3 |
| **S8** | 0.2 | 0.3 | 0.1 | 0.1 | 0 | 0.2 | 0 | 0.1 |

### Пошаговое моделирование марковской цепи

Функция `simulation_Markov_chain (matrix, pi, eps)` принимает на вход: матрицу переходных вероятностей, начальный вектор состояний и точность, с которой необходимо сравнивать соседние результирующие векторы.

Вычисления включают в себя:
- `current_matrix = np.linalg.matrix_power(matrix, steps_count)` - возведение матрицы переходных вероятностей в степень номера шага
- `result = np.dot(pi, current_matrix)` - умножение полученной матрицы на начальный вектор распределения по состояниям.

Также, внутри этой функции формируются данные, используемые для построения графика изменения
среднеквадратического отклонения на каждом шагу моделирования, передаваемые в функцию `plot_graph_of_standard_deviation`.

На выходе мы получаем `(result, steps_count - 1)` - распределение по состояниям и количество шагов, при котором не наблюдается разницы между двумя соседними векторами распределения по состояниям больше, чем задаваемая точность.

### Аналитическое решение задачи

(P<sup>T</sup> - E) * _&pi;_ = 0,

где P<sup>T</sup> - транспонированная матрица переходных вероятностей,

E - единичная матрица

_&pi;_<sub>1</sub>+_&pi;_<sub>2</sub>+…+_&pi;_<sub>n</sub> = 1

Решение системы линейных уравнений дает предельные вероятности пребывания системы в определенных состояниях.

Решение системы уравнений происходит в функции `simulation_Markov_chain_analytically (matrix)`, которая принимает на вход матрицу переходных вероятностей:

- `a = matrix.transpose() - np.identity(len(matrix))` - (P<sup>T</sup> - E)
- `a[len(matrix) - 1] = np.ones(len(matrix))` - замена последней строки матрицы P<sup>T</sup> на единичную строку
- `b = np.zeros(len(matrix))`
	
    `b[len(matrix) - 1] = 1` - подготовка правой части уравнения
- `np.linalg.solve(a, b)` - решение линейной системы уравнений (P<sup>T</sup> - E) = (0, 0, …, 0, 1)<sup>T</sup>

## Результат работы программы

В результате, на различных начальных векторах состояний для данной матрицы переходных состояний получается следующий вектор распределения по состояниям: [0.125 0.125 0.125 0.125 0.125 0.125 0.125 0.125].

Также, программа строит график зависимости изменения
среднеквадратического отклонения на каждом шагу численного моделирования для всех начальных векторов состояний.
